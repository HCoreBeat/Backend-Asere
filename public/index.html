<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control del Servidor</title>
    <link rel="icon" href="/logo_2.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div id="dynamic-greeting" class="greeting"></div>
    <!-- Este contenedor se usará para mostrar el mensaje dinámico de saludo -->
    <!-- Barra de navegación para cambiar entre vistas -->
    <nav class="top-nav" role="navigation" aria-label="Navegación principal">
        <div class="nav-left">
            <a class="nav-brand" href="#">Asere Panel</a>
        </div>
        <div class="nav-right">
            <button class="nav-btn" id="nav-dashboard">Panel</button>
            <button class="nav-btn" id="nav-stats">Estadísticas</button>
        </div>
    </nav>

    <main role="main">
        <div id="main-dashboard">
            <div class="container">
        <h1><i class="fas fa-server"></i>Servidor Asere</h1>
        <div class="status-section">
            <div class="status-card">
                <h3><i class="fas fa-heartbeat"></i> Estado del Servidor</h3>
                <p>Estado: <span class="value">Funcionando correctamente</span></p>
                <p>Versión: <strong class="value">1.3.0</strong></p>
            </div>
            <div class="status-card">
                <h3><i class="fas fa-clock"></i> Tiempo de Actividad</h3>
                <p>Inicio: <span class="value" id="start-time"></span></p>
                <p>Actividad: <span id="uptime" class="value">Calculando...</span></p>
            </div>
            <div class="status-card">
                <h3><i class="fas fa-chart-line"></i> Estadísticas Rápidas</h3>
                <p>Total de solicitudes: <span id="total-requests" class="value">Cargando...</span></p>
                <p>Última solicitud: <span id="last-request" class="value">Cargando...</span></p>
            </div>
            <div class="status-card">
                <h3><i class="fas fa-users"></i> Usuarios</h3>
                <p>Usuarios únicos: <span id="unique-users" class="value">Cargando...</span></p>
                <p>Usuarios recurrentes: <span id="recurring-users" class="value">Cargando...</span></p>
            </div>
        </div>
        <div class="btn-group">
            <button class="btn" id="view-stats-button"><i class="fas fa-chart-bar"></i> Ver Estadísticas</button>
            <button class="btn" onclick="clearConsole()"><i class="fas fa-broom"></i> Limpiar Consola</button>
            <button class="btn" onclick="copyLogsToClipboard()"><i class="fas fa-copy"></i> Copiar Logs</button>
        </div>
        <div class="actions-right">
            <button id="update-comparison-button" class="btn"><i class="fas fa-sync-alt"></i> Actualizar</button>
            <div class="settings-dropdown" id="settings-dropdown">
                <button id="settings-toggle" class="btn nav-btn"><i class="fas fa-cog"></i></button>
                <div class="settings-menu" id="settings-menu" aria-hidden="true">
                    <button class="settings-item" id="action-clear-statistics"><i class="fas fa-trash-alt"></i> Limpiar estadísticas</button>
                    <button class="settings-item" id="action-export-csv"><i class="fas fa-file-csv"></i> Exportar CSV (filtradas)</button>
                </div>
            </div>
        </div>
    </div>

            <div class="console-container">
                <div class="console-header"><i class="fas fa-terminal"></i> Server Logs</div>
                <div id="log-output"></div>
            </div>

            <div id="new-orders-panel" style="display:none">
                <div class="panel-header">
                    <h2>Pedidos Nuevos</h2>
                    <button id="close-orders-panel">&times;</button>
                </div>
                <div id="orders-list">
                    <!-- Los pedidos nuevos se mostrarán aquí -->
                </div>
            </div>

            <button id="new-orders-button">
                <span id="new-orders-count">0</span>
            </button>

            <div id="notification-panel">
                <!-- Las notificaciones se agregarán dinámicamente aquí -->
            </div>
        </div> <!-- /container -->
    </div> <!-- /main-dashboard -->

        <!-- Página de estadísticas separada (oculta por defecto) -->
        <section id="stats-page" class="stats-page" style="display:none" role="region" aria-label="Página de estadísticas">
            <div class="stats-header">
                <h2>Estadísticas Detalladas</h2>
                <div class="stats-controls">
                    <input id="stats-search" type="search" placeholder="Buscar por IP, país o afiliado...">
                    <select id="stats-country-filter">
                        <option value="">Todos los países</option>
                    </select>
                    <select id="stats-sort">
                        <option value="date_desc">Fecha: Más recientes</option>
                        <option value="date_asc">Fecha: Más antiguas</option>
                    </select>
                    <button id="stats-back" class="btn" aria-label="Volver al panel">Volver</button>
                </div>
            </div>
            <div id="stats-loader" class="stats-loader" aria-hidden="true" style="display:none"></div>
            <div id="stats-list" class="stats-list" aria-live="polite"></div>
            <div id="stats-pagination" class="stats-pagination"></div>
        </section>
    </main>

    <div id="new-orders-panel" style="display:none">
        <div class="panel-header">
            <h2>Pedidos Nuevos</h2>
            <button id="close-orders-panel">&times;</button>
        </div>
        <div id="orders-list">
            <!-- Los pedidos nuevos se mostrarán aquí -->
        </div>
    </div>

    <button id="new-orders-button">
        <span id="new-orders-count">0</span>
    </button>

    <div id="notification-panel">
        <!-- Las notificaciones se agregarán dinámicamente aquí -->
    </div>

    <!-- Modal de confirmación para acciones peligrosas -->
    <div id="modal-overlay" class="modal-overlay" role="dialog" aria-modal="true" style="display:none">
        <div class="modal" role="document" aria-labelledby="modal-title">
            <h3 id="modal-title">Confirmar acción</h3>
            <p id="modal-message">¿Estás seguro? Esta acción no se puede deshacer.</p>
            <div class="modal-controls">
                <input id="modal-confirm-input" placeholder="Escribe BORRAR para confirmar" aria-label="Confirmar acción">
                <button id="modal-confirm-btn" class="btn btn-danger" disabled>Confirmar</button>
                <button id="modal-cancel-btn" class="btn">Cancelar</button>
            </div>
        </div>
    </div>

    <script src="/scripts.js"></script>
</body>
</html>
